DROP TABLE UTILISATEUR, FORMATION, CONFERENCE,QUESTION,QUESTIONNAIRE,PARTICIPE,REPONSETEXTE,REPONSEQCM,CHOIXQCM ;

CREATE TABLE UTILISATEUR (
	ID_USER INTEGER,
	PSEUDO VARCHAR(10), /* identifiant de connexion */
	PASSWORD VARCHAR(30),
	NOM VARCHAR(20),
	PRENOM VARCHAR(20),
	DATENAISSANCE INTEGER,
	ROLE VARCHAR(10), /* admin,citoyen ou visiteur */
	SITUATION_PRO VARCHAR(20),
	ETUDES VARCHAR(20),
	SEXE VARCHAR(1)
	/* Autres infos */ 
	CONSTRAINT user_PK PRIMARY KEY(ID_USER)
    );

CREATE TABLE CONFERENCE(
	ID_CONFERENCE INTEGER,
	TITRE VARCHAR(20),
	THEME VARCHAR(20),
	DATEC DATE,
	
	ETAT_ACTUEL VARCHAR(10),
	/* Participants/Votants , résultat ?*/
	CONSTRAINT conference_PK PRIMARY KEY(ID_CONFERENCE),
	);

CREATE TABLE QUESTIONNAIRE(
	ID_QUESTIONNAIRE INTEGER,
	TITRE VARCHAR(20),
	THEME VARCHAR(20),
	CREATEUR INTEGER, /* ref à ID_USER */
	DATEQ DATE,
	FORMATION VARCHAR(100),
	ID_CONFERENCE INTEGER,
	CONSTRAINT questionnaire_PK PRIMARY KEY(ID_QUESTIONNAIRE),
	CONSTRAINT questionnaire_user_fk FOREIGN KEY (CREATEUR) REFERENCES UTILISATEUR (ID_USER),
	CONSTRAINT questionnaire_conf_fk FOREIGN KEY (ID_CONFERENCE) REFERENCES CONFERENCE (ID_CONFERENCE),
)	

CREATE TABLE QUESTION(
	ID_QUESTION INTEGER,
	NUMERO INTEGER,
	TYPE VARCHAR(6), /* QCM OU TEXTE */
	CONTENU VARCHAR(100),
	ID_QUESTIONNAIRE INTEGER,
	CONSTRAINT question_PK PRIMARY KEY(ID_QUESTION),
	CONSTRAINT question_questionnaire_fk FOREIGN KEY (ID_QUESTIONNAIRE) REFERENCES QUESTIONNAIRE (ID_QUESTIONNAIRE),
	
)

CREATE TABLE REPONSETEXTE(
	ID_TEXTE INTEGER,
	CONTENU VARCHAR(100),
	ID_QUESTION INTEGER,
	CITOYEN INTEGER,
	CONSTRAINT reponsetexte_PK PRIMARY KEY(ID_TEXTE),
	CONSTRAINT reponsetxt_question_fk FOREIGN KEY (ID_QUESTION) REFERENCES QUESTION (ID_QUESTION),
	CONSTRAINT reponsetxt_user_fk FOREIGN KEY (CITOYEN) REFERENCES UTILISATEUR (ID_USER),
)

CREATE TABLE REPONSEQCM(
	ID_QCM INTEGER,
	CONTENU VARCHAR(100),
	ID_QUESTION INTEGER,
	CITOYEN INTEGER,
	CONSTRAINT reponseqcm_PK PRIMARY KEY(ID_QCM),
	CONSTRAINT reponseqcm_question_fk FOREIGN KEY (ID_QUESTION) REFERENCES QUESTION (ID_QUESTION),
	CONSTRAINT reponseqcm_user_fk FOREIGN KEY (CITOYEN) REFERENCES UTILISATEUR (ID_USER),
)

CREATE TABLE CHOIXQCM(
	ID_CHOIX INTEGER,
	NUMERO INTEGER,
	CONTENU VARCHAR(100),
	ID_QUESTION INTEGER,
	CONSTRAINT choixqcm_PK PRIMARY KEY(ID_CHOIX),
	CONSTRAINT choixqcm_question_fk FOREIGN KEY (ID_QUESTION) REFERENCES QUESTION (ID_QUESTION),
)

CREATE TABLE PARTICIPE(
	ID_USER INTEGER,
	ID_CONFERENCE INTEGER,
	CONSTRAINT participe_PK PRIMARY KEY(ID_USER,ID_CONFERENCE),
	CONSTRAINT participe_user_fk FOREIGN KEY (ID_USER) REFERENCES UTILISATEUR (ID_USER),
	CONSTRAINT participe_conf_fk FOREIGN KEY (ID_CONFERENCE) REFERENCES CONFERENCE (ID_CONFERENCE)
)